---
title: 202501123CTF学习笔记49
date: 2025-01-23
tags:
 - CTF
 - CTFLearn
categories:
   - 命理学 Numerology
isShowComments: true
publish: true






















---

<Boxx/>

从0开始学习CTF，了解CTF基本规则、方法，这是开始打卡学习的第64天

今日内容：抓包技术-HTTPS协议&APP&小程序&PC应用&WEB&转发联动

[[toc]]

- 小迪安全视频地址【[🔗传送门]([https://www.bilibili.com/video/BV123yAYMEwb/)】

<!-- more -->

# 第27章：算法分析&传输加密&数据格式&密文存储&代码混淆&逆向保护

## 知识点结构

- 存储密码加密-应用对象
- 传输加密编码-发送回显
- 数据传输格式-统一格式
- 代码特性混淆-开发语言



## 传输数据-编码型&加密型等

### 演示案例1：

我们尝试搜索`inurl:id=mq==`，找到如下地址的网页：

```
https://indialms.in/wfp_login.php?r_id=MQ==
```

正常URL如果没有经过加密编码的话，正常是以下形式：

```
https://indialms.in/wfp_login.php?r_id=1
```

这里`MQ==`，通过加密编码工具解码以后，得出的结果就是`1`

![image-20250122205147741](/img/ctfLearn/image-20250122205147741.png)

> CaptfEncoder是一款可扩展跨平台网络安全工具套件，提供网络安全相关编码转换、古典密码、密码学、非对称加密、特殊编码、杂项等工具，并聚合各类在线工具。

此时如果我们让`id=2`，也就是直接输入一个2到地址栏，发现是访问不到的。这里我们可以通过加密我们想要的数字，就能找到对应的页面。



### 了解原因：

- 数据在传输时进行了编码，因为安全测试漏洞的时候，通常都会进行数据的修改增加再提交测试。
- 对方的服务器可能会在接受请求的时候，先解码再代入再代入，如果我们还是传入未进行加密的参数payload，传过去的参数就无法识别，也就测试无效。



### 正确的思路：

测试的时候要对payload进行和对方同样的加密后再提交。



### 案例演示2：

视频中演示的是小迪的博客后台登录页，在输入账号密码后点击提交，就能在F12开发者工具的NetWork中看到发送的请求，密码是加密过后再请求的，这里我们找一个其他需要登录的【[网站](https://iam.pt.ouchn.cn/am/UI/Login)】做替代。

![image-20250122212848452](/img/ctfLearn/image-20250122212848452.png)

通过以上方法我们发现我们传入的参数被加密了，而且是账号密码一起被加密了，我们用BurpSuite重新抓取，查看一下数据包的内容：

![image-20250122214331261](/img/ctfLearn/image-20250122214331261.png)

> 这里在用BurpSuite抓包的时候，尝试用浏览器插件代理，但发现和F12开发者工具显示的请求不一致，所以用了设置里的全局代理，应该是这个网站做了重定向，导致插件代理未生效，理论上Proxifier应该也能代理，此处需要下次注意。



### 爆破思路：

- 如果我们要进行密码爆破，面对没有加密的账号密码，直接用字典内的值进行替换即可。
- 如果密码加密后，需要我们执行密码算法，让password的值与写好的加密方式同等加密才行。



### 演示案例3：

尝试抓一下APP数据包，需要在BurpSuite打开监听WLAN局域网内IP端口，然后在模拟器中的WLAN中设置无线网络代理：

![image-20250122215944780](/img/ctfLearn/image-20250122215944780.png)

- 我们打开欢乐斗地主这个应用，发现抓到的包基本上都是经过加密的，就像是最简单的Get请求都在地址后边加上了加密后的参数，甚至连返回结果都是加密过的，这就意味着我们如果不知道加解密方式的话，是无法去测的。
- ![image-20250122220810963](/img/ctfLearn/image-20250122220810963.png)
- 所以如果是正常的、未加密的返回值，这里返回的不太正常，导致我们不清楚这个返回值是做什么的，所以我们能测的点就少，少就漏洞发现的几率就小。

像是视频上，我们也会用到一些加密的一些情况

- BiliBili的BV号应该就是经过加密的，直接就体现在视频地址中。

- 搜狐视频的地址是Base64加密的，通过Base64解码即可得到原地址。

  ```
  https://tv.sohu.com/v/MjAyNDEwMzEvbjYyMDAyMDUzMC5zaHRtbA==.html?fid=2&pvid=4d4db6d26aa0a4ec
  ```

  看到其中有Base64特征的`==`符号，我们尝试解密得到`20241031/n620020530.shtml`



### 思考：

**为什么要对参数进行加密？**

**答：**因为这样加密可以保证一些东西不被泄露，比如路径地址中带了1234这种明显数字顺序特征的地址，那我们就可以猜测会不会有1235、1236？如果把1234加密，如果我们在渗透时，看不懂加密后的样子，就看不出什么其他东西来。



### 影响：

漏洞探针-因为要搞清楚加密的方式才能按照正确的加密方式才能伪造请求去测试，针对后期做漏洞探针或者漏洞挖掘的时候，我们必须要按照固定的加密方式来伪造。



## 数据传输格式-统一格式

数据的格式有各种各样的形式，比如json、xml等。

### 案例分析

像是我们常用的Get方法，就是在地址后加`?a=1&b=2`，类似这样的参数。我们用POST方法的话，一般是json格式的参数，比如以下方式：

```json
{
  "username": "admin",
  "password": "123456"
}
```

如果我们测试PayLoad的时候，我们爆破的时候，要有的放矢，找到对应的格式对应的地方去修改（迪总讲的也太细了吧，幸好这里我学过）



### 影响：

- **发送方影响到漏洞探针**-我们需要按照特定的方式去伪造、去发送、去测漏洞，比如必须传json格式的参数，发过去看看有没有安全问题，这就设计到漏洞探针

- **回显方影响到数据分析**-回显方是对方回显过来的数据，如果是我们不了解各个格式的意思，就影响到了我们进行数据分析。包括我们有时候返回的数据是加密值，我们还要去解密出来看结果。

  **举例子：**比如我们传入了一个错误的参数，服务端应该返回错误代码，或者显示”错误“，如果这时候发现回显的数据是加密的，加密后的结果是看不出来是正确还是错误的。



### 编码&加密：

- Base64编码，推荐工具【[SRK Toolbox](https://btsrk.me/)】进行Base64编码、解码

  ```
  1经过编码后是		MQ==
  2经过编码后是		Mg==
  ```

- md5加密（视频中zblog的后台登录密码就是md5加密的），推荐工具【[CMD5](https://www.cmd5.org/)】，进行md5格式文本的解密

  ![image-20250122225605640](/img/ctfLearn/image-20250122225605640.png)



### 挖坑：

后续课程会讲解如何判断、找出这些编码、加密方法的规律



### BurpSuite参数解释：

- Host：主机地址
- Method：请求方式
- URL：路径地址
- Params：是否有参数
- Status：HTTP响应状态码
- Length：长度
- MIME type：返回格式

![image-20250122230432796](/img/ctfLearn/image-20250122230432796.png)



## 存储密码加密-应用对象

密码存储-Web&系统&三方应用

### 案例演示：

用phpStudy搭建zzcms网站，搭建过程不再详细赘述，结果如下图所示：

![image-20250122232338372](/img/ctfLearn/image-20250122232338372.png)